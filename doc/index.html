<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><link href="https://docs.tongfamily.com/lib/doc/" rel="canonical"/><link href="../files/" rel="prev"/><link href="../media/logo_small.png" rel="icon"/><meta content="mkdocs-1.6.0, mkdocs-material-9.5.34" name="generator"/><title>Documentation - lib</title><link href="../assets/stylesheets/main.35f28582.min.css" rel="stylesheet"/><link href="../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../assets/_markdown_exec_pyodide.css" rel="stylesheet"/><link href="../assets/_markdown_exec_ansi.css" rel="stylesheet"/><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent="indigo" data-md-color-primary="deep-purple" data-md-color-scheme="slate" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#documentation"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="lib" class="md-header__button md-logo" data-md-component="logo" href=".." title="lib"> <img alt="logo" src="../media/logo_big.png"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> lib </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Documentation </span> </div> </div> </div> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0"> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="lib" class="md-nav__button md-logo" data-md-component="logo" href=".." title="lib"> <img alt="logo" src="../media/logo_big.png"/> </a> lib </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href=".."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../install/"> <span class="md-ellipsis"> Installation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../files/"> <span class="md-ellipsis"> Files </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> Documentation </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#creating-and-editing-the-documentation"> <span class="md-ellipsis"> Creating and editing the documentation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#creating-a-pushing-a-netlify-static-sites"> <span class="md-ellipsis"> Creating a pushing a Netlify static sites </span> </a> <nav aria-label="Creating a pushing a Netlify static sites" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#detailed-instructions"> <span class="md-ellipsis"> Detailed instructions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#dealing-with-submodules-requires-more-work"> <span class="md-ellipsis"> Dealing with Submodules (Requires more work) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#creating-a-read-the-docs-project"> <span class="md-ellipsis"> Creating a Read The Docs Project </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="documentation"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.</span> Documentation<a class="headerlink" href="#documentation" title="Permanent link">¶</a></h1> <p>The main documentation lives in <a href="https://github.com/richtong/README.md">README.md</a> and you can browse in the GitHub repo.</p> <p>The <a href="https://github.com/richtong/lib/docs">Docs</a> has the core documents in mkdocs format.</p> <h2 id="creating-and-editing-the-documentation"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.1</span> Creating and editing the documentation<a class="headerlink" href="#creating-and-editing-the-documentation" title="Permanent link">¶</a></h2> <p>Run <code>make mkdocs</code> to run a local server and check the content with a browser on your machine.</p> <h2 id="creating-a-pushing-a-netlify-static-sites"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.2</span> Creating a pushing a Netlify static sites<a class="headerlink" href="#creating-a-pushing-a-netlify-static-sites" title="Permanent link">¶</a></h2> <p>With a paid account you can easily create a private documentation from a private github repo. The main trick is to make sure to edit the netlify.toml file from the main template with your name. Also you need a requirements.txt that pipenv or poetry can generate. And you need a runtime.txt with the version number of the Python that you need.</p> <p>To make this work you need a Netlify account and then you authenticate with GitHub using their local applications. The only real issue is that private submodules are pain, they need a <a href="https://answers.netlify.com/t/support-guide-how-do-i-access-private-repositories-in-the-build-environment/723">deployment</a> key per submodule as of February 2023. And you should probably do this with a DevOps account on GitHub so it is not tied to an individual developer.</p> <h3 id="detailed-instructions"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.2.1</span> Detailed instructions<a class="headerlink" href="#detailed-instructions" title="Permanent link">¶</a></h3> <p>In here is the process:</p> <ol> <li>You will need the standard tooling from ./lib</li> <li>So put your repo as a submodules inside the ./src repo and cd into your repo</li> <li>Then copy the Makefile pieces with cp ./src/lib/Makefile.base &gt;&gt; Makefile Adjust the Makefile includes so it points to ./src/lib/include.mk and ./src/lib/include.python.mk (you can delete this last if the project doesn’t just python.</li> <li>Check that it works by running make and you should see a list of things to do.</li> <li>Now install the basic tooling files with make install-repo. This will only add files and blow anything away. Now you should edit the mkdocs.yaml so that the entries for the file and where it lives are correct, by convention it will be <a href="https://docs.tongfamily.com"><em>repo</em>.docs.tongfamily.ai</a> or whatever your org is.</li> <li>Edits your documentation starting at ./docs/index.md and add files as needed. To set the navigation edit mkdocs.yaml</li> <li>Test this works by running make mkdocs which will create a local server which you can access at <a href="http://localhost:8000">http://localhost:8000</a> and debug your site.</li> <li>Now if you are a command line jockey install the netlify cli with <code>npm install -g netlify</code></li> <li>Or just go to <a href="https://netlify.com">Netlify</a> and login as <a href="admin@tne.ai">admin</a> and the password is 1Password</li> <li>In the middle of the screen, you will see a button called add new site and select choose an existing project, then connect ot GitHub with that button and you should see pick a repository so lect the netdrones organization and search for your repo.</li> <li>If this is working, it should fille things in for you but specifically the branch to deploy is main and the build command is mkdocs build. BY THE WAY there is no magic here, there are two files netlify.toml and runtime.txt that were added that tell netlify this is a mkdocs site and what version of Python to run on the client.</li> <li>Hit deploy site</li> <li>YOu should see the Netlify runner starting and it should say Production main@HEAD and building. And when it stops at Published, click on the arrow and click on Open Production deploy and make sure that this is the right site. It has a random url by the way that is on the netlify site. And this should look the same as the local build.</li> <li>Now click on the top where you see the site name and you should be back at Site Overview, there should be a huge number 2 that says Set up Custom domain</li> <li>Now enter the domain that you want. NOTE: DO NOT BE LIKE ME and just type netdrones.ai, this will wipe out our company website instead put what you want the name to be like <em>repo</em>.docs.netdrones.ai so process.docs.netdrones.ai for the ./src/process repo amd hit add</li> <li>What you press verify it should say good news and you should be done. make sure to hit force HTTPS below and then wait for the domain to work. It is going to say Awaiting External DNS, but don’t worry about that just click on the name and make sure it works!</li> </ol> <h3 id="dealing-with-submodules-requires-more-work"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.2.2</span> Dealing with Submodules (Requires more work)<a class="headerlink" href="#dealing-with-submodules-requires-more-work" title="Permanent link">¶</a></h3> <p>The one issue with Netlify is how it handles submodules. If you have private submodules, then you need to create a <a href="https://docs.github.com/en/developers/overview/managing-deploy-keys">GitHub machine user</a> which has read access to all the submodule repositories. With personal accounts, you need to add the machine user (or bot account) to every repository. With organizations you do that or you need to add them to the team (and this does create another seat you need to pay for).</p> <p>For “free” individual users, to GitHub page and then to the repo you want in <code>Settings &gt; General &gt; Collaborators &gt; Add People</code>. It is probably easiest to create a new account with a <code>-bot</code> or <code>-netlify</code> suffix and the same user name and make sure it has two factor on as it has lots of read permissions. Unfortunately there is no command line way to do this but you can call the GitHub API to do this addition <a href="https://stackoverflow.com/questions/13004061/how-does-one-add-a-collaborator-in-github-using-the-command-line">curl</a> or <a href="https://docs.github.com/en/rest/collaborators/collaborators?apiVersion=2022-11-28#add-collaborator">gh cli</a></p> <div class="highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>curl<span class="w"> </span>-i<span class="w"> </span>-u<span class="w"> </span><span class="s2">"my_user_name:my_password"</span><span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="se">\</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span>-d<span class="w"> </span><span class="s1">''</span><span class="w"> </span><span class="s1">'https://api.github.com/repos/my_gh_userid/my_repo/collaborators/my_collaborator_id'</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="c1"># the brew install gh version is a little easier to</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>a#<span class="w"> </span>GitHub<span class="w"> </span>CLI<span class="w"> </span>api
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="c1"># https://cli.github.com/manual/gh_api</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>gh<span class="w"> </span>api<span class="w"> </span><span class="se">\</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">"Accept: application/vnd.github+json"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">  </span>/repos/OWNER/REPO/collaborators
</span></code></pre></div> <h2 id="creating-a-read-the-docs-project"><span class="enumerate-headings-plugin enumerate-heading-plugin">4.3</span> Creating a Read The Docs Project<a class="headerlink" href="#creating-a-read-the-docs-project" title="Permanent link">¶</a></h2> <p>This works if you want the documentation free since they allow free hosting. This only works for open sourced documents</p> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="Last update"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 13, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "navigation.instant", "navigation.tracking", "navigation.sections", "navigation.indexes", "navigation.top", "navigation.instant.prefetch", "navigation.path", "navigation.expand", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src="../assets/javascripts/bundle.56dfad97.min.js"></script> <script src="../assets/_markdown_exec_pyodide.js"></script> <script src="../js/mkdocs-charts-plugin.js"></script> <script src="https://cdn.jsdelivr.net/npm/vega@5"></script> <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script> <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script> </body> </html>